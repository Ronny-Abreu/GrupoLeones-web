<section id="contacto" class="py-20 bg-white">
  <div class="container mx-auto px-4 max-w-7xl">
    <div class="grid lg:grid-cols-2 gap-12 items-center">
      <!-- Left Side - Promotional Card -->
      <div class="bg-gradient-to-br from-red-600 to-red-800 rounded-3xl p-8 md:p-12 text-white relative overflow-hidden">
        <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16"></div>
        <div class="absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full translate-y-12 -translate-x-12"></div>
        
        <div class="relative z-10">
          <div class="mb-6">
            <svg class="w-16 h-16 text-white/80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
            </svg>
          </div>
          
          <h3 class="text-3xl md:text-4xl font-bold mb-6">
            ¬°Impulsa tus ideas con nosotros!
          </h3>
          
          <p class="text-lg md:text-xl mb-8 text-white/90 leading-relaxed">
            √önete a nuestro plan estrat√©gico y transforma tu visi√≥n en realidad. 
            Con Grupo Leones, cada idea tiene el potencial de convertirse en un √©xito extraordinario.
          </p>
          
          <div class="space-y-4 mb-8">
            <div class="flex items-center gap-3">
              <svg class="w-6 h-6 text-white/80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
              <span class="text-white/90">Asesor√≠a personalizada 24/7</span>
            </div>
            <div class="flex items-center gap-3">
              <svg class="w-6 h-6 text-white/80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
              <span class="text-white/90">Acceso a todas nuestras filiales</span>
            </div>
            <div class="flex items-center gap-3">
              <svg class="w-6 h-6 text-white/80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
              <span class="text-white/90">Estrategias probadas de crecimiento</span>
            </div>
          </div>
          
          <p class="text-white/80 text-lg font-medium">
            ¬øListo para dar el siguiente paso? 
            <br class="hidden md:block">
            <span class="text-white font-bold">¬°Cont√°ctanos ahora!</span>
          </p>
        </div>
      </div>

      <!-- Right Side - Contact Form -->
      <div class="bg-gray-50 rounded-3xl p-8 md:p-12">
        <div class="text-center mb-8">
          <h3 class="text-3xl font-bold text-gray-900 mb-4">Env√≠anos tu consulta</h3>
          <p class="text-gray-600">Completa el formulario y nos pondremos en contacto contigo en menos de 24 horas</p>
        </div>

        <form id="contactForm" class="space-y-6">
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <label for="contactNombre" class="block text-sm font-medium text-gray-700 mb-2">Nombre completo</label>
              <input 
                type="text" 
                id="contactNombre" 
                name="nombre" 
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-300 text-black"
                placeholder="Tu nombre"
              />
            </div>
            <div>
              <label for="contactEmail" class="block text-sm font-medium text-gray-700 mb-2">Correo electr√≥nico</label>
              <input 
                type="email" 
                id="contactEmail" 
                name="email" 
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-300 text-black"
                placeholder="tu@email.com"
              />
            </div>
          </div>

          <div>
            <label for="contactTelefono" class="block text-sm font-medium text-gray-700 mb-2">Tel√©fono (opcional)</label>
            <input 
              type="tel" 
              id="contactTelefono" 
              name="telefono"
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-300 text-black"
              placeholder="+1 809 999 0000"
            />
          </div>

          <div>
            <label for="contactAsunto" class="block text-sm font-medium text-gray-700 mb-2">Asunto</label>
            <select 
              id="contactAsunto" 
              name="asunto" 
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-300 text-black"
            >
              <option value="">Selecciona un tema</option>
              <option value="Consulta General">Consulta General</option>
              <option value="Leones Capital">Leones Capital</option>
              <option value="Leones Seguros">Leones Seguros</option>
              <option value="Leones Finanzas">Leones Finanzas</option>
              <option value="Leones Marketing">Leones Marketing</option>
              <option value="Leones Talento">Leones Talento</option>
              <option value="Leones Impacto">Leones Impacto</option>
            </select>
          </div>

          <div>
            <label for="contactMensaje" class="block text-sm font-medium text-gray-700 mb-2">Mensaje</label>
            <textarea 
              id="contactMensaje" 
              name="mensaje" 
              rows="5" 
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-300 resize-none text-black"
              placeholder="Cu√©ntanos c√≥mo podemos ayudarte..."
            ></textarea>
          </div>

          <button 
            type="submit" 
            id="contactSubmitBtn"
            class="w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2"
          >
            <span class="flex items-center justify-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
              </svg>
              Enviar mensaje
            </span>
          </button>

          <!-- SUCCESS MESSAGE -->
          <div id="contactSuccessMessage" class="hidden">
            <div class="bg-green-50 border-2 border-green-200 rounded-xl p-6 text-center">
              <div class="flex justify-center mb-4">
                <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center">
                  <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                  </svg>
                </div>
              </div>
              <h4 class="text-xl font-bold text-green-800 mb-2">¬°Mensaje enviado exitosamente! üéâ</h4>
              <p class="text-green-700 mb-4">
                Tu consulta ha sido recibida correctamente. Te responderemos en un plazo m√°ximo de 24 horas.
              </p>
              <div class="bg-green-100 rounded-lg p-3">
                <p class="text-green-800 text-sm">
                  <strong>Tip:</strong> Revisa tu bandeja de entrada y spam por si acaso.
                </p>
              </div>
            </div>
          </div>

          <!-- ERROR MESSAGE -->
          <div id="contactErrorMessage" class="hidden">
            <div class="bg-red-50 border-2 border-red-200 rounded-xl p-6 text-center">
              <div class="flex justify-center mb-4">
                <div class="w-16 h-16 bg-red-500 rounded-full flex items-center justify-center">
                  <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                </div>
              </div>
              <h4 class="text-xl font-bold text-red-800 mb-2">Error al enviar el mensaje ‚ùå</h4>
              <p class="text-red-700 mb-4" id="contactErrorText">Por favor, int√©ntalo de nuevo.</p>
              <div class="bg-red-100 rounded-lg p-3">
                <p class="text-red-800 text-sm">
                  Si el problema persiste, contacta directamente con nosotros.
                </p>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('contactForm') as HTMLFormElement;
    const successMessage = document.getElementById('contactSuccessMessage') as HTMLElement;
    const errorMessage = document.getElementById('contactErrorMessage') as HTMLElement;
    const errorText = document.getElementById('contactErrorText') as HTMLElement;
    const submitBtn = document.getElementById('contactSubmitBtn') as HTMLButtonElement;

    if (!form || !successMessage || !errorMessage || !errorText || !submitBtn) {
      console.error('‚ùå Elementos del formulario de contacto no encontrados');
      return;
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      console.log('üìù Formulario de contacto enviado');
      
      successMessage.classList.add('hidden');
      errorMessage.classList.add('hidden');
      
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      
      console.log('üìù Datos del contacto:', data);
      
      if (!data.nombre || !data.email || !data.asunto || !data.mensaje) {
        showError('Por favor, completa todos los campos obligatorios.');
        return;
      }

      // Validar email
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(data.email as string)) {
        showError('Por favor, ingresa un email v√°lido.');
        return;
      }

      const originalContent = submitBtn.innerHTML;
      submitBtn.innerHTML = `
        <span class="flex items-center justify-center gap-2">
          <svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
          </svg>
          Enviando...
        </span>
      `;
      submitBtn.disabled = true;

      try {
        const response = await fetch('/api/send-email', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        });

        const contentType = response.headers.get('content-type');
        if (!contentType || !contentType.includes('application/json')) {
          throw new Error('El servidor no devolvi√≥ una respuesta JSON v√°lida');
        }

        const result = await response.json();
        if (response.ok && result.success) {
          console.log('üéâ ¬°√âxito! Mostrando mensaje de √©xito del contacto...');
          form.reset();
          showSuccess();
        } else {
          throw new Error(result.message || 'Error al enviar el mensaje');
        }
      } catch (error) {
        console.error('üí• Error en contacto:', error);
        showError(`Error: ${error instanceof Error ? error.message : 'Error desconocido'}`);
      } finally {
        // Restaurar bot√≥n
        submitBtn.innerHTML = originalContent;
        submitBtn.disabled = false;
      }
    });

    function showSuccess() {

      errorMessage.classList.add('hidden');
      successMessage.classList.remove('hidden');
      
      successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
      
      setTimeout(() => {
        successMessage.classList.add('hidden');
      }, 10000);
    }

    function showError(message: string) {
      console.log('‚ùå Mostrando mensaje de error del contacto:', message);

      errorText.textContent = message;
      successMessage.classList.add('hidden');
      errorMessage.classList.remove('hidden');
      
      errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
      
      setTimeout(() => {
        errorMessage.classList.add('hidden');
      }, 8000);
    }
  });
</script>
